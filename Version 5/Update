Made a stable working update. 
