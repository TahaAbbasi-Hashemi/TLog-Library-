This is my updated version.

You may have to edit logging.cpp line 121

I wrote this version to make the program easier to read and less intensive on the thread making the log
This puts more work on the thread processing the logs. 
